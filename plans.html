<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarFitNova | Select Mission</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- DYNAMIC THEME ENGINE --- */
        :root { --primary: #b829ff; } /* Default Purple, JS will update this */

        body { margin: 0; padding: 0; background-color: #000000; color: white; font-family: 'Courier New', monospace; overflow-x: hidden; background: linear-gradient(180deg, #050a1c 0%, #000000 100%); min-height: 100vh; display: flex; flex-direction: column; align-items: center; -webkit-font-smoothing: antialiased; }
        
        .stars-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 40px), radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 30px); background-size: 550px 550px; animation: twinkle 60s infinite linear; opacity: 0.5; z-index: -1; pointer-events: none; }
        @keyframes twinkle { from { background-position: 0 0; } to { background-position: -100px 100px; } }

        /* STATUS BANNER */
        .status-banner { width: 100%; background: rgba(255, 0, 0, 0.1); border-bottom: 1px solid red; color: red; text-align: center; padding: 10px 0; font-size: 0.8rem; letter-spacing: 2px; font-weight: bold; margin-top: 80px; opacity: 0; animation: fadeInUp 0.8s ease-out forwards; }
        .blink { animation: blink 1s infinite; }

        /* NAV */
        nav { position: fixed; top: 0; left: 0; width: 100%; padding: 20px 10%; box-sizing: border-box; display: flex; justify-content: space-between; align-items: center; background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 5000; }
        .logo { font-size: 1.5rem; font-weight: bold; letter-spacing: 5px; cursor: pointer; color: white; text-decoration: none; transition: 0.3s; }
        .logo:hover { color: var(--primary); text-shadow: 0 0 15px var(--primary); }
        ul { list-style: none; display: flex; gap: 20px; margin: 0; padding: 0; } 
        li { color: #888; cursor: pointer; transition: 0.3s; font-size: 0.9rem; } 
        li:hover, li.active { color: var(--primary); } a { text-decoration: none; color: inherit; } 

        .mission-header { text-align: center; margin: 40px 0 60px 0; opacity: 0; animation: fadeInUp 0.8s ease-out 0.2s forwards; }
        h1 { font-size: 3rem; margin-bottom: 10px; letter-spacing: 5px; text-transform: uppercase; text-shadow: 0 0 20px rgba(255, 255, 255, 0.1); } 
        p { color: var(--primary); font-size: 1.1rem; letter-spacing: 2px; font-weight: bold; }

        /* CARDS */
        .missions-container { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; width: 90%; margin-bottom: 100px; }
        .mission-card { background: rgba(10, 20, 30, 0.8); border: 1px solid #333; width: 300px; padding: 40px 30px; text-align: center; transition: 0.3s; position: relative; overflow: hidden; opacity: 0; transform: translateY(30px); animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        .mission-card:nth-child(1) { animation-delay: 0.3s; }
        .mission-card:nth-child(2) { animation-delay: 0.5s; }
        .mission-card:nth-child(3) { animation-delay: 0.7s; }
        
        .mission-card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 0 30px var(--primary); background: #0a050f; }
        .mission-card.popular { border-color: var(--primary); box-shadow: 0 0 20px var(--primary); } 
        .mission-card.popular .price { color: var(--primary); }
        
        .rank { color: #555; font-size: 0.9rem; letter-spacing: 2px; margin-bottom: 20px; display: block; text-transform: uppercase; }
        .mission-title { font-size: 1.8rem; margin-bottom: 10px; color: white; letter-spacing: 2px; }
        .price { font-size: 2.5rem; color: var(--primary); font-weight: bold; margin: 20px 0; } 
        .price span { font-size: 1rem; color: #888; font-weight: normal; margin-left: 5px; }
        
        /* CLEANER LIST STYLES */
        .features { list-style: none; padding: 0; text-align: left; margin-bottom: 40px; margin-top: 20px; } 
        .features li { padding: 12px 0; border-bottom: 1px solid #222; color: #ccc; font-size: 0.85rem; display: flex; align-items: center; gap: 10px; } 
        .features li::before { content: "\f00c"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--primary); font-size: 0.8rem; }
        .legendary-text { color: #ffd700 !important; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); font-weight: bold; }
        .legendary-text::before { color: #ffd700 !important; }

        .select-btn { width: 100%; padding: 15px 0; background: transparent; border: 1px solid #555; color: #aaa; font-family: inherit; font-size: 0.9rem; letter-spacing: 3px; cursor: pointer; transition: 0.3s; font-weight: bold; }
        .select-btn:hover { border-color: white; color: white; background: rgba(255,255,255,0.1); }
        .mission-card.popular .select-btn { border-color: var(--primary); color: var(--primary); }
        .mission-card.popular .select-btn:hover { background: var(--primary); color: black; box-shadow: 0 0 30px var(--primary); }

        /* MODALS */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: 0.3s; backdrop-filter: blur(5px); }
        .modal-overlay.open { opacity: 1; visibility: visible; }
        .payment-box { width: 450px; background: #050a1c; border: 2px solid var(--primary); padding: 40px; text-align: center; position: relative; box-shadow: 0 0 50px var(--primary); transform: scale(0.9); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .modal-overlay.open .payment-box { transform: scale(1); }
        .pay-title { color: white; font-size: 1.5rem; letter-spacing: 3px; border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 20px; }
        .pay-detail { font-size: 1.1rem; color: #aaa; margin-bottom: 30px; line-height: 1.6; }
        .pay-price { color: var(--primary); font-weight: bold; font-size: 1.3rem; }
        .pay-actions { display: flex; gap: 15px; justify-content: center; }
        .pay-btn { flex: 1; padding: 15px; border: none; font-weight: bold; cursor: pointer; letter-spacing: 2px; font-family: inherit; transition: 0.3s; }
        .btn-confirm { background: var(--primary); color: black; } .btn-confirm:hover { background: white; box-shadow: 0 0 20px white; }
        .btn-deny { background: transparent; border: 1px solid #ff4400; color: #ff4400; } .btn-deny:hover { background: #ff4400; color: white; }
        
        .loader-container { display: none; margin: 30px 0; }
        .loader-bar { width: 100%; height: 4px; background: #111; margin-bottom: 10px; position: relative; overflow: hidden; }
        .loader-fill { height: 100%; width: 0%; background: var(--primary); animation: loadPay 2.5s ease-in-out forwards; }
        .success-view { display: none; }
        .success-icon { font-size: 4rem; color: #00ff00; margin-bottom: 20px; text-shadow: 0 0 30px #00ff00; animation: popIn 0.5s; }
        .code-box { background: black; border: 1px dashed #00ff00; padding: 15px; color: #00ff00; font-size: 1.5rem; font-weight: bold; letter-spacing: 4px; margin: 20px 0; }
        .copy-hint { font-size: 0.7rem; color: #555; margin-bottom: 20px; }
        .enter-lab-btn { width: 100%; padding: 15px; background: #00ff00; color: black; font-weight: bold; border: none; cursor: pointer; letter-spacing: 2px; margin-top: 10px; transition: 0.3s; }
        .enter-lab-btn:hover { background: white; box-shadow: 0 0 30px #00ff00; }

        /* ACCESS ALERT */
        #denied-alert { position: fixed; top: 15%; left: 50%; transform: translateX(-50%); background: #000; border: 1px solid #ff0000; padding: 15px 40px; text-align: center; color: #ff0000; font-size: 1rem; font-weight: bold; letter-spacing: 3px; box-shadow: 0 0 20px rgba(255, 0, 0, 0.3); z-index: 30000; opacity: 0; visibility: hidden; transition: opacity 0.3s; }
        #denied-alert.visible { opacity: 1; visibility: visible; }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes blink { 50% { opacity: 0; } }
        @keyframes loadPay { 0% { width: 0%; } 20% { width: 10%; } 50% { width: 60%; } 100% { width: 100%; } }
        @keyframes popIn { 0% { transform: scale(0); } 80% { transform: scale(1.2); } 100% { transform: scale(1); } }
    </style>

    <script>
        (function() {
            function getUserPrefix() { return localStorage.getItem('mfn_user') ? (localStorage.getItem('mfn_user') + '_') : 'GUEST_'; }
            let prefix = getUserPrefix();
            let lvl = parseInt(localStorage.getItem(prefix + 'mfn_level') || '1');
            
            // COLOR LOGIC SAME AS OTHER PAGES
            let color = '#b829ff'; // Default Nova (Purple)
            if(lvl >= 21) color = '#ffd700'; // Eternal (Gold)
            else if(lvl >= 16) color = '#6a00ff'; // Singularity (Deep Violet)
            else if(lvl >= 11) color = '#00e5ff'; // Pulsar (Cyan)
            else if(lvl >= 6) color = '#ff4400'; // Supernova (Orange)
            
            document.documentElement.style.setProperty('--primary', color);
        })();
    </script>
</head>
<body>

    <div class="stars-bg"></div>

    <div id="denied-alert">[ LOCKED ] &nbsp; AUTHENTICATION REQUIRED</div>

    <div class="status-banner"><span class="blink">‚óè</span> SYSTEM STATUS: PRE-LAUNCH PROTOCOL // ACCEPTING WAITLIST ONLY</div>

    <nav>
        <a href="index.html" class="logo">MFN</a>
        <ul>
            <li><a href="#" onclick="checkAccess(event, 'ascension.html')">RANKS</a></li>
            <li><a href="#" onclick="checkAccess(event, 'lab.html')">LAB</a></li>
            <li class="active">PLANS</li>
        </ul>
    </nav>

    <div class="mission-header"><h1>SELECT MISSION</h1><p>> SECURE YOUR SEAT ON THE STARSHIP.</p></div>

    <div class="missions-container">
        <div class="mission-card">
            <span class="rank">TIER 1 // PIONEER</span>
            <h2 class="mission-title">APOLLO</h2>
            <div class="price">$10<span>/mo</span></div>
            <ul class="features">
                <li>Full System Access</li>
                <li>Standard Workouts</li>
                <li>Automated Nutrition</li>
                <li>Community Uplink</li>
            </ul>
            <button class="select-btn" onclick="openPayment('APOLLO', 10, 'APL')">INITIATE</button>
        </div>

        <div class="mission-card popular">
            <span class="rank" style="color: var(--primary);">TIER 2 // VANGUARD</span>
            <h2 class="mission-title">ARTEMIS</h2>
            <div class="price">$15<span>/mo</span></div>
            <ul class="features">
                <li>Includes All Apollo Features</li>
                <li>Advanced Hypertrophy</li>
                <li>Private Developer Chat</li>
                <li>Manual Data Checks</li>
            </ul>
            <button class="select-btn" onclick="openPayment('ARTEMIS', 15, 'ART')">INITIATE</button>
        </div>

        <div class="mission-card">
            <span class="rank">TIER 3 // INTERSTELLAR</span>
            <h2 class="mission-title">VOYAGER</h2>
            <div class="price">$25<span>/mo</span></div>
            <ul class="features">
                <li>Includes All Artemis Features</li>
                <li>Private Video Coaching</li>
                <li>1-on-1 Founder Mentorship</li>
                <li class="legendary-text">Physical Sword Reward</li>
            </ul>
            <button class="select-btn" onclick="openPayment('VOYAGER', 25, 'VGR')">INITIATE</button>
        </div>
    </div>

    <div id="paymentModal" class="modal-overlay">
        <div class="payment-box">
            
            <div id="payStep1">
                <div class="pay-title">MISSION CONTRACT</div>
                <div class="pay-detail">
                    YOU ARE ABOUT TO INITIALIZE THE <span id="payPlanName" style="color:white; font-weight:bold;"></span> PROTOCOL.<br><br>
                    SYSTEM CHARGE: <span id="payAmount" class="pay-price"></span> / MONTH<br><br>
                    DO YOU AUTHORIZE THIS TRANSACTION?
                </div>
                <div class="pay-actions">
                    <button class="pay-btn btn-confirm" onclick="processTransaction()">AUTHORIZE</button>
                    <button class="pay-btn btn-deny" onclick="closePayment()">DECLINE</button>
                </div>
            </div>

            <div id="payStep2" class="loader-container">
                <div class="pay-title" style="border:none; color:white;">PROCESSING...</div>
                <div class="loader-bar"><div class="loader-fill"></div></div>
                <div style="color:var(--primary); font-size:0.8rem; letter-spacing:2px;" class="blink">ESTABLISHING SECURE LINK...</div>
            </div>

            <div id="payStep3" class="success-view">
                <div class="success-icon"><i class="fa-solid fa-circle-check"></i></div>
                <div class="pay-title" style="border:none; color:#00ff00;">PAYMENT SUCCESSFUL</div>
                <div class="pay-detail">
                    ACCESS GRANTED.<br>SAVE YOUR ACCESS CODE:
                </div>
                
                <div id="generatedCode" class="code-box">...</div>
                <div class="copy-hint">THIS IS YOUR LOGIN KEY</div>

                <button class="enter-lab-btn" onclick="copyAndRedirect()">COPY CODE & GO TO LOGIN</button>
            </div>

        </div>
    </div>

    <script>
        let selectedPlan = "";
        let currentPrefix = "";

        function openPayment(plan, price, prefix) {
            selectedPlan = plan;
            currentPrefix = prefix;
            document.getElementById("payStep1").style.display = "block";
            document.getElementById("payStep2").style.display = "none";
            document.getElementById("payStep3").style.display = "none";
            document.getElementById("payPlanName").innerText = plan;
            document.getElementById("payAmount").innerText = "$" + price;
            document.getElementById("paymentModal").classList.add("open");
        }

        function closePayment() {
            document.getElementById("paymentModal").classList.remove("open");
        }

        function processTransaction() {
            document.getElementById("payStep1").style.display = "none";
            document.getElementById("payStep2").style.display = "block";

            setTimeout(() => {
                document.getElementById("payStep2").style.display = "none";
                document.getElementById("payStep3").style.display = "block";
                
                let randomNum = Math.floor(1000 + Math.random() * 9000); 
                let code = `MFN-${currentPrefix}-${randomNum}`;
                
                document.getElementById("generatedCode").innerText = code;
                localStorage.setItem('mfn_valid_code', code); 
                localStorage.setItem('mfn_selected_plan', selectedPlan);
            }, 2500);
        }

        function copyAndRedirect() {
            let code = document.getElementById("generatedCode").innerText;
            navigator.clipboard.writeText(code).then(function() {
                window.location.href = 'index.html?action=login';
            }, function(err) {
                window.location.href = 'index.html?action=login';
            });
        }

        /* --- ACCESS CONTROL --- */
        function checkAccess(e, url) {
            e.preventDefault();
            if(localStorage.getItem('mfn_authenticated') === 'true') {
                window.location.href = url;
            } else {
                var alertBox = document.getElementById("denied-alert");
                alertBox.classList.add("visible");
                setTimeout(() => {
                    alertBox.classList.remove("visible");
                    window.location.href = 'index.html?action=login'; // Redirect to login
                }, 1500);
            }
        }
    </script>
</body>
</html>